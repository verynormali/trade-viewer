{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!doctype html>\
<html lang="en">\
<head>\
  <meta charset="utf-8" />\
  <meta name="viewport" content="width=device-width, initial-scale=1" />\
  <title>Trade Mini Viewer</title>\
  <style>\
    html, body \{ height: 100%; margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; \}\
    #app \{ display: grid; grid-template-rows: auto 1fr auto; height: 100%; \}\
    header \{ padding: 10px 14px; border-bottom: 1px solid #e5e7eb; \}\
    header h1 \{ font-size: 16px; margin: 0; font-weight: 600; \}\
    header .meta \{ font-size: 12px; color: #6b7280; margin-top: 4px; \}\
    #chart \{ position: relative; \}\
    #chart > div \{ position:absolute; inset:0; \}\
    footer \{ padding: 8px 14px; border-top: 1px solid #e5e7eb; display:flex; gap:8px; align-items:center; \}\
    input[type=url] \{ width: 100%; padding:8px; border:1px solid #d1d5db; border-radius:8px; \}\
    button \{ padding:8px 10px; border:1px solid #d1d5db; background:#fff; border-radius:10px; cursor:pointer; \}\
    button:hover \{ background:#f9fafb; \}\
    .legend \{ position:absolute; top:8px; left:8px; background:rgba(255,255,255,.9); border:1px solid #e5e7eb; border-radius:10px; padding:6px 8px; font-size:12px; \}\
    .badge \{ display:inline-block; padding:2px 6px; border:1px solid #d1d5db; border-radius:999px; font-size:11px; margin-left:6px; \}\
  </style>\
  <script src="https://unpkg.com/lightweight-charts@4.2.1/dist/lightweight-charts.standalone.production.js"></script>\
</head>\
<body>\
  <div id="app">\
    <header>\
      <h1>Trade Mini Viewer <span id="symbol" class="badge">\'97</span></h1>\
      <div class="meta" id="meta">Loading\'85</div>\
    </header>\
    <div id="chart">\
      <div id="chart-root"></div>\
      <div class="legend" id="legend">Entry / SL / TP markers will appear here.</div>\
    </div>\
    <footer>\
      <input type="url" id="dataUrl" placeholder="JSON URL (same-origin on GitHub Pages recommended)" />\
      <button id="loadBtn">Load</button>\
      <button id="resetBtn" title="Reset zoom">Reset</button>\
      <button id="fitBtn" title="Fit content">Fit</button>\
    </footer>\
  </div>\
\
  <script>\
    const qs = new URLSearchParams(location.search);\
    const defaultDataUrl = qs.get('data') || './data/trade_sample.json';\
\
    const rootEl = document.getElementById('chart-root');\
    const metaEl = document.getElementById('meta');\
    const symbolEl = document.getElementById('symbol');\
    const legendEl = document.getElementById('legend');\
    const dataInput = document.getElementById('dataUrl');\
\
    let chart, series;\
\
    function makeChart() \{\
      if (chart) \{\
        chart.remove();\
      \}\
      chart = LightweightCharts.createChart(rootEl, \{\
        width: rootEl.clientWidth,\
        height: Math.max(320, window.innerHeight - 140),\
        layout: \{ background: \{ type: 'solid', color: '#ffffff' \}, textColor: '#111827' \},\
        grid: \{ vertLines: \{ color: '#f3f4f6' \}, horzLines: \{ color: '#f3f4f6' \} \},\
        timeScale: \{ timeVisible: true, secondsVisible: false, rightOffset: 4, barSpacing: 8 \},\
        rightPriceScale: \{ borderVisible: false \},\
      \});\
      series = chart.addCandlestickSeries(\{ upColor: '#26a69a', downColor: '#ef4444', borderVisible: false, wickUpColor: '#26a69a', wickDownColor: '#ef4444' \});\
      window.addEventListener('resize', () => chart.applyOptions(\{ width: rootEl.clientWidth, height: Math.max(320, window.innerHeight - 140) \}));\
    \}\
\
    async function loadData(url) \{\
      metaEl.textContent = 'Loading ' + url + ' \'85';\
      try \{\
        const res = await fetch(url, \{ cache: 'no-cache' \});\
        if (!res.ok) throw new Error('HTTP ' + res.status);\
        const data = await res.json();\
        renderData(data);\
        metaEl.textContent = 'Loaded ' + new Date().toLocaleString();\
      \} catch (err) \{\
        console.error(err);\
        metaEl.textContent = 'Failed to load data: ' + err.message;\
      \}\
    \}\
\
    function renderData(data) \{\
      makeChart();\
\
      const candles = (data.candles || []).map(c => (\{\
        time: Math.floor(new Date(c.time).getTime() / 1000),\
        open: Number(c.open), high: Number(c.high), low: Number(c.low), close: Number(c.close)\
      \}));\
      series.setData(candles);\
\
      symbolEl.textContent = (data.symbol || '?') + ' \'b7 ' + (data.interval || 'TF');\
\
      // Price lines\
      if (data.entry && data.entry.price) \{\
        series.createPriceLine(\{ price: Number(data.entry.price), title: 'Entry', lineWidth: 1, color: '#111827' \});\
      \}\
      if (typeof data.sl === 'number') \{\
        series.createPriceLine(\{ price: Number(data.sl), title: 'SL', lineWidth: 1, color: '#ef4444' \});\
      \}\
      if (typeof data.tp === 'number') \{\
        series.createPriceLine(\{ price: Number(data.tp), title: 'TP', lineWidth: 1, color: '#22c55e' \});\
      \}\
\
      // Markers\
      const markers = [];\
      if (data.entry && data.entry.time) \{\
        markers.push(\{ time: Math.floor(new Date(data.entry.time).getTime()/1000), position: 'belowBar', color: '#111827', shape: 'arrowUp', text: 'ENTRY' \});\
      \}\
      if (data.exit && data.exit.time) \{\
        markers.push(\{ time: Math.floor(new Date(data.exit.time).getTime()/1000), position: 'aboveBar', color: '#6b7280', shape: 'arrowDown', text: 'EXIT' \});\
      \}\
      if (typeof data.sl === 'number' && data.entry && data.entry.time) \{\
        // Optional extra SL marker near entry time\
        markers.push(\{ time: Math.floor(new Date(data.entry.time).getTime()/1000), position: 'belowBar', color: '#ef4444', shape: 'circle', text: 'SL ' + data.sl \});\
      \}\
      if (typeof data.tp === 'number' && data.exit && data.exit.time) \{\
        markers.push(\{ time: Math.floor(new Date(data.exit.time).getTime()/1000), position: 'aboveBar', color: '#22c55e', shape: 'circle', text: 'TP ' + data.tp \});\
      \}\
      series.setMarkers(markers);\
\
      // Legend text\
      const rr = typeof data.rr === 'number' ? `RR $\{data.rr\}` : '';\
      const side = data.entry && data.entry.side ? data.entry.side.toUpperCase() : '';\
      const note = data.notes ? ` \'97 $\{data.notes\}` : '';\
      legendEl.textContent = `$\{data.symbol || ''\} $\{data.interval || ''\} $\{side\} $\{rr\}$\{note\}`.trim();\
\
      // Fit visible range around the trade\
      const times = candles.map(c => c.time);\
      const tMin = times.length ? Math.min(...times) : undefined;\
      const tMax = times.length ? Math.max(...times) : undefined;\
      if (tMin && tMax) chart.timeScale().setVisibleRange(\{ from: tMin, to: tMax \});\
    \}\
\
    // Controls\
    document.getElementById('loadBtn').addEventListener('click', () => \{\
      const url = dataInput.value.trim();\
      if (url) loadData(url);\
    \});\
    document.getElementById('resetBtn').addEventListener('click', () => chart.timeScale().resetTimeScale());\
    document.getElementById('fitBtn').addEventListener('click', () => chart.timeScale().fitContent());\
\
    // Init\
    dataInput.value = defaultDataUrl;\
    loadData(defaultDataUrl);\
  </script>\
</body>\
</html>}